<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download</title>
    <style type="text/css">
    </style>
</head>

<body>
    <div>
        <div>
            <input id="smlie-low" type="checkbox">low
            <input id="smlie-videoid" type="text">
            <button onclick="onclickLoadSmile();">Smile</button>
            <button onclick="onclickLoadSmileCancel();">cancel</button>
        </div>
        <div>
            <input id="dmc-low" type="checkbox">low
            <input id="dmc-videoid" type="text">
            <button onclick="onclickLoadDmc();">Dmc</button>
            <button onclick="onclickLoadDmcCancel();">cancel</button>
        </div>
    </div>
</body>

<script>
    const { NicoNicoDownloader } = require("../app/js/niconico-downloader");

    {
        const id_elm = document.getElementById("smlie-videoid");
        id_elm.value = "sm29316071";
    }
    {
        const id_elm = document.getElementById("dmc-videoid");
        id_elm.value = "sm34731203";
    }

    let smile_downlader = null;
    const onclickLoadSmile = async ()=>{
        const video_id = document.getElementById("smlie-videoid").value;
        const low_ok = document.getElementById("smlie-low").checked;

        smile_downlader = new NicoNicoDownloader(video_id, "./", !low_ok);
        const result =await smile_downlader.download((state)=>{
            console.log("progress: ", state);
        });
        console.log("result: ", result);
    }; 
    const onclickLoadSmileCancel = ()=>{
        if(smile_downlader){
            smile_downlader.cancel();
        }
    };

    let dmc_downlader = null;
    const onclickLoadDmc = async ()=>{
        const video_id = document.getElementById("dmc-videoid").value;
        const low_ok = document.getElementById("dmc-low").checked;

        dmc_downlader = new NicoNicoDownloader(video_id, "./", !low_ok);
        const result = await dmc_downlader.download((state)=>{
            console.log("progress: ", state);
        });
        console.log("result: ", result);
    };  

    const onclickLoadDmcCancel = async ()=>{
        if(dmc_downlader){
            dmc_downlader.cancel();
        }
    };
</script>

</html>