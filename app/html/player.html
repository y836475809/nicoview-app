<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="../css/app.css">
    <style type="text/css">
    </style>
</head>

<body>
    <window-titlebar></window-titlebar>
    <player-main-page></player-main-page>
</body>
<script src="../../node_modules/riot/riot+compiler.min.js"></script>
<script type="riot/tag" src="../tags/player-main-page.tag"></script>
<script type="riot/tag" src="../tags/modal-dialog.tag"></script>
<script type="riot/tag" src="../tags/player-tags.tag"></script>
<script type="riot/tag" src="../tags/player-seek.tag"></script>
<script type="riot/tag" src="../tags/player-volume.tag"></script>
<script type="riot/tag" src="../tags/player-controls.tag"></script>
<script type="riot/tag" src="../tags/player-video.tag"></script>
<script type="riot/tag" src="../tags/player-page.tag"></script>
<script type="riot/tag" src="../tags/player-info-page.tag"></script>
<script type="riot/tag" src="../tags/player-user.tag"></script>
<script type="riot/tag" src="../tags/comment-setting-dialog.tag"></script>
<script type="riot/tag" src="../tags/comment-ng-setting.tag"></script>
<script type="riot/tag" src="../tags/comment-display-setting.tag"></script>
<script type="riot/tag" src="../tags/open-video-form.tag"></script>
<script type="riot/tag" src="../tags/window-titlebar.tag"></script>

<script>
    /* globals riot */
    const { ipcRenderer } = window.electron;
    const { IPC_CHANNEL } = window.IPC_CHANNEL;
    var { logger } = window.logger; // eslint-disable-line
    
    let toast_wrapper = null;

    const obs = riot.observable();
    
    obs.on("player-page:toastr", (args) => {
        const { type, title, message } = args;
        toast_wrapper[type](title, message);
    });
    
    window.onload = () => {
        const { ToastWrapper } = window.ToastWrapper;
        toast_wrapper = new ToastWrapper();
    };

    riot.mount("window-titlebar", {
        obs:obs, title:"", window_name:"player"
    });

    ipcRenderer.on(IPC_CHANNEL.MAIN_TOASTR, (event, args)=>{
        const { type, title, message } = args;
        toast_wrapper[type](title, message);
    });

    ipcRenderer.on(IPC_CHANNEL.MAIN_HTML_LOADED, (event)=>{
        riot.mount("player-main-page", {obs});
    });
</script>

</html>