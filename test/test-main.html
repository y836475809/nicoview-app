<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <script>
        window.jQuery = window.$ = require('jquery');
    </script>
    <script type="text/javascript" src="../node_modules/datatables.net/js/jquery.dataTables.min.js"></script>
    <link rel="stylesheet" type="text/css" href="../node_modules/datatables.net-dt/css/jquery.dataTables.min.css">
    <script type="text/javascript" src="../lib/colResize/dataTables.colResize.js"></script>
    <link rel="stylesheet" type="text/css" href="../node_modules/jquery-contextmenu/dist/jquery.contextMenu.min.css">

    <script src="../node_modules/riot/riot+compiler.min.js"></script>
    <script type="riot/tag" src="../app/tags/base-datatable.tag"></script>
    <script type="riot/tag" src="../app/tags/select-page-tabs.tag"></script>
    <script type="riot/tag" src="../app/tags/library-page.tag"></script>
    <script type="riot/tag" src="../app/tags/search-page.tag"></script>

    <style type="text/css">
        html {
            height: 100%;
        }

        body {
            display:grid;
            grid-template-rows: 80px 1fr;
            grid-template-columns: 1fr 1fr;

            width: 100%;
            height: 100%;
            margin: 0;
        }

        select-page-tabs{
            grid-row: 1 / 2;
            grid-column: 1 / 3;
        }

        #page1 {
            grid-row: 2 / 3;
            grid-column: 1 / 3;
        }
        #page2 {
            grid-row: 2 / 3;
            grid-column: 1 / 3;
        }
    </style>
</head>

<body>
    <select-page-tabs></select-page-tabs>
    <div id="page1">
        <input type="button" value="show" onClick="showPlayer();">     
        <input type="button" value="size" onClick="setSize();">     
        <library-page></library-page>
    </div>
    <div id="page2">
        <search-page></search-page>
    </div>
    <div id="page3">
        test
    </div>
</body>

<script>
    const remote = require('electron').remote;
    const base_dir = remote.getGlobal('sharedObj').base_dir;

    const time_format = require("../app/js/time_format");
    console.log(time_format.format(1332592373506));

    require('jquery-contextmenu');
    var obs = riot.observable();
    
    this.index = 0;
    let selectPage = (index)=>{
        let page1 = document.getElementById("page1");
        let page2 = document.getElementById("page2");
        let page3 = document.getElementById("page3");

        let list = ["none", "none", "none"];
        list[index] = "block";
        //obs.trigger("update")
        page1.style.display = list[0];
        page2.style.display = list[1];
        page3.style.display = list[2];       
    };

    selectPage(this.index);


    obs.on("selindex", (index) => {
        console.log("selindex = ", index)
        this.index = index;
        
        selectPage(index)
    })
    
    function Employee(image, name, position, salary, office) {
         this.image = image;
         this.name = name;
         this.position = position;
         this.salary = salary;
         this._office = office;

         this.office = function () {
             return this._office;
         }
    };
    let showPlayer = () => {
        console.log("showPlayer")
        const data_dir = `${base_dir}/test/datatables/data`
        const data_http1 = "http://localhost:8000/brie1"
        const data_http2 = "http://localhost:8000/brie2"
        const datas = [
            new Employee(`${data_dir}/brie.jpg`, "1 http Nixon", "System Architect", "$3,120", "Edinburgh"),
            new Employee(`${data_dir}/brie.jpg`, "2 Tiger Nixon", "System Architect", "$3,120", "Edinburgh"),
            new Employee(`${data_dir}/cheddar.jpg`, "3 Garrett Winters", "Director", "$5,300", "Edinburgh"),
            new Employee(`${data_dir}/brie.jpg`, "4 Garrett", "Director", "$5,300", "Edinburgh"),
            new Employee(`${data_dir}/brie.jpg`, "5 Winters", "Director", "$5,300", "Edinburgh"),
            new Employee(`${data_dir}/cheddar.jpg`, "6 t Winters", "Director", "$5,300", "Edinburgh"),
            new Employee(`${data_dir}/cheddar.jpg`, "7 http Winters", "Director", "$5,300", "Edinburgh"),
        ]
        obs.trigger("receivedData", datas)
    }
    let setSize = () => {
        obs.trigger("setSize-p1");
    };

    riot.mount('select-page-tabs', {tabs:['Tab 1','Tab 2','Tab 3']});
    riot.mount('#page1 library-page');
    riot.mount('#page2 search-page');

    let self = this;
    const timeout = 200;
    let timer;
    window.addEventListener('resize', () => {
        clearTimeout(timer);
        timer = setTimeout(() => {
            obs.trigger("resizeEndEvent", {
                    w: window.innerWidth, 
                    h: window.innerHeight -200 
                 });
        }, timeout);
    });

</script>

</html>