<!doctype html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>test</title>
</head>

<body>
    <app-root></app-root>
</body>

<script src="../../node_modules/riot/riot+compiler.min.js"></script>
<script src="../../node_modules/riotx/dist/riotx.min.js"></script>
<script type="riot/tag" src="./app-root.tag"></script>
<script>
    /* globals riot riotx */
    const store = new riotx.Store({
        state: {
            text: "Riot",
            lists: []
        },

        actions: {
            updateText: (context, text) => {
                return Promise
                    .resolve()
                    .then(() => {
                        context.commit("updateText", text);
                    });
            },
            addList: (context) => {
                return Promise
                    .resolve()
                    .then(() => {
                        context.commit("addList");
                    });
            },
            deleteList: (context) => {
                return Promise
                    .resolve()
                    .then(() => {
                        context.commit("deleteList");
                    });
            }
        },

        mutations: {
            updateText: (context, text) => {
                context.state.text = text.str;
                return ["changed"];
            },
            addList: (context) => {
                const text = context.state.text;
                context.state.lists.push(text);
                return ["changed"];
            },
            deleteList: (context) => {
                context.state.lists.pop();
                return ["changed"];
            }
        },

        getters: {
            state: (context) => {
                return context.state;
            }
        }
    });

    riotx.add(store);
    riot.compile(function () {
        riot.mount("app-root");
    });
</script>

</html>