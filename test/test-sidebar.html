<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test sidebar</title>
    <link rel="stylesheet" type="text/css" href="../app/css/app.css">
    <style type="text/css">
    </style>
</head>

<body>
    <button type="button" onclick="onclickAddItem();">add item</button>
    <button type="button" onclick="onclickgetData();">get data</button>
    <button type="button" onclick="onclickdelselItems();">del selected items</button>
    <div class="cp_menu">
        <accordion params={acdn1}></accordion>
        <accordion params={acdn2}></accordion>
    </div>
</body>

<script src="../node_modules/riot/riot+compiler.min.js"></script>
<script type="riot/tag" src="../app/tags/accordion.tag"></script>
<script>
    /* globals riot */
    const {remote} = require("electron");
    const {Menu} = remote;
    const shared_obj = remote.getGlobal("sharedObj");
    var app_base_dir = shared_obj.base_dir;  // eslint-disable-line
    const obs = riot.observable(); // eslint-disable-line
    riot.mount("accordion", obs);
    const p = console.log;

    const createMenu = () => {
        const nemu_templete = [
            { 
                label: "delete", click() {
                    obs.trigger("delete-selected-items");
                }
            }
        ];
        return Menu.buildFromTemplate(nemu_templete);
    };

    const items = [
        { title: "name1", data: "data1" },
        { title: "name2", data: "data2" },
        { title: "name3", data: "data3" },
        { title: "name4", data: "data4" },
        { title: "name5", data: "data5" },
    ];
    this.acdn1 = {
        title : "search1",
        name: "entries1",
        expand: true,
        items: items,
        oncontextmenu: ()=>{
            const menu = createMenu("entries1");
            menu.popup({window: remote.getCurrentWindow()});
        }
    };

    this.acdn2 = {
        title : "search2",
        name: "entries2",
        expand: false,
        items: items,
        oncontextmenu: ()=>{
            const menu = createMenu("entries2");
            menu.popup({window: remote.getCurrentWindow()});
        }
    };

    const onclickAddItem = () => {
        obs.trigger("add-items", 
            [{ title: "name6", data: "data6" }]
        );
    };

    const getItemFunc = (args) => {
        p("data = ", args);
    };
    const onclickgetData = () => {
        obs.trigger("get-items", (getItemFunc));
    };

    const onclickdelselItems = () => {
        obs.trigger("delete-selected-items");
    };
</script>

</html>